# WXT å¼€å‘å¿«é€Ÿå‚è€ƒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åˆ›å»ºé¡¹ç›®
```bash
# åˆ›å»ºæ–°é¡¹ç›®
npm create wxt@latest my-extension

# è¿›å…¥é¡¹ç›®ç›®å½•
cd my-extension

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### é¡¹ç›®ç»“æ„
```
my-extension/
â”œâ”€â”€ entrypoints/          # å…¥å£ç‚¹ç›®å½•
â”‚   â”œâ”€â”€ background.ts     # åå°è„šæœ¬
â”‚   â”œâ”€â”€ content.ts        # å†…å®¹è„šæœ¬
â”‚   â”œâ”€â”€ popup/           # å¼¹çª—é¡µé¢
â”‚   â””â”€â”€ options/         # è®¾ç½®é¡µé¢
â”œâ”€â”€ components/          # React ç»„ä»¶
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”œâ”€â”€ assets/             # é™æ€èµ„æº
â”œâ”€â”€ wxt.config.ts       # WXT é…ç½®
â””â”€â”€ package.json
```

## ğŸ“‹ å¸¸ç”¨å‘½ä»¤

```bash
# å¼€å‘
npm run dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev:firefox      # Firefox å¼€å‘æ¨¡å¼

# æ„å»º
npm run build            # ç”Ÿäº§æ„å»º
npm run build:firefox    # Firefox æ„å»º

# æ‰“åŒ…
npm run zip              # åˆ›å»ºå‘å¸ƒåŒ…
npm run zip:firefox      # Firefox å‘å¸ƒåŒ…

# ç±»å‹æ£€æŸ¥
npm run type-check       # TypeScript ç±»å‹æ£€æŸ¥

# æ¸…ç†
npm run clean            # æ¸…ç†æ„å»ºæ–‡ä»¶
```

## âš™ï¸ é…ç½®æ–‡ä»¶

### wxt.config.ts
```typescript
import { defineConfig } from 'wxt';

export default defineConfig({
  // æ‰©å±•æ¸…å•é…ç½®
  manifest: {
    name: 'æˆ‘çš„æ‰©å±•',
    description: 'æ‰©å±•æè¿°',
    version: '1.0.0',
    permissions: ['activeTab', 'storage'],
    host_permissions: ['https://example.com/*'],
  },
  
  // å¼€å‘é…ç½®
  dev: {
    server: { port: 3000 }
  },
  
  // æ„å»ºé…ç½®
  build: {
    outDir: 'dist'
  },
  
  // Vite é…ç½®
  vite: () => ({
    // è‡ªå®šä¹‰ Vite é…ç½®
  })
});
```

## ğŸ§© å…¥å£ç‚¹å¼€å‘

### Background Script
```typescript
// entrypoints/background.ts
export default defineBackground({
  main() {
    console.log('Background script started');
    
    // ç›‘å¬æ‰©å±•å®‰è£…
    chrome.runtime.onInstalled.addListener(() => {
      console.log('Extension installed');
    });
    
    // ç›‘å¬æ¶ˆæ¯
    chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
      if (message.type === 'PING') {
        sendResponse({ type: 'PONG' });
      }
    });
  }
});
```

### Content Script
```typescript
// entrypoints/content.ts
export default defineContentScript({
  matches: ['https://example.com/*'],
  main() {
    console.log('Content script loaded');
    
    // å‘é€æ¶ˆæ¯åˆ° background
    chrome.runtime.sendMessage({ type: 'PING' });
    
    // ç›‘å¬æ¥è‡ª popup çš„æ¶ˆæ¯
    chrome.runtime.onMessage.addListener((message) => {
      if (message.type === 'HIGHLIGHT') {
        // é«˜äº®é¡µé¢å†…å®¹
        document.body.style.backgroundColor = 'yellow';
      }
    });
  }
});
```

### React é¡µé¢
```typescript
// entrypoints/popup/App.tsx
import React, { useState, useEffect } from 'react';

function App() {
  const [tabs, setTabs] = useState<chrome.tabs.Tab[]>([]);
  
  useEffect(() => {
    // è·å–æ‰€æœ‰æ ‡ç­¾é¡µ
    chrome.tabs.query({}, (tabs) => {
      setTabs(tabs);
    });
  }, []);
  
  const closeTab = (tabId: number) => {
    chrome.tabs.remove(tabId);
    setTabs(tabs.filter(tab => tab.id !== tabId));
  };
  
  return (
    <div className="w-80 p-4">
      <h1 className="text-xl font-bold mb-4">æ ‡ç­¾é¡µç®¡ç†å™¨</h1>
      <div className="space-y-2">
        {tabs.map(tab => (
          <div key={tab.id} className="flex items-center justify-between p-2 border rounded">
            <span className="truncate">{tab.title}</span>
            <button 
              onClick={() => closeTab(tab.id!)}
              className="text-red-500 hover:text-red-700"
            >
              Ã—
            </button>
          </div>
        ))}
      </div>
    </div>
  );
}

export default App;
```

## ğŸ”§ å¸¸ç”¨ Hooks

### Chrome Storage Hook
```typescript
import { useState, useEffect } from 'react';

export function useChromeStorage<T>(key: string, defaultValue: T) {
  const [value, setValue] = useState<T>(defaultValue);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    chrome.storage.local.get([key]).then((result) => {
      setValue(result[key] ?? defaultValue);
      setLoading(false);
    });
  }, [key, defaultValue]);
  
  const updateValue = async (newValue: T) => {
    await chrome.storage.local.set({ [key]: newValue });
    setValue(newValue);
  };
  
  return [value, updateValue, loading] as const;
}
```

### Chrome Tabs Hook
```typescript
export function useChromeTabs() {
  const [tabs, setTabs] = useState<chrome.tabs.Tab[]>([]);
  
  useEffect(() => {
    const loadTabs = async () => {
      const tabs = await chrome.tabs.query({});
      setTabs(tabs);
    };
    
    loadTabs();
    
    // ç›‘å¬æ ‡ç­¾é¡µå˜åŒ–
    const handleCreated = (tab: chrome.tabs.Tab) => {
      setTabs(prev => [...prev, tab]);
    };
    
    const handleRemoved = (tabId: number) => {
      setTabs(prev => prev.filter(tab => tab.id !== tabId));
    };
    
    chrome.tabs.onCreated.addListener(handleCreated);
    chrome.tabs.onRemoved.addListener(handleRemoved);
    
    return () => {
      chrome.tabs.onCreated.removeListener(handleCreated);
      chrome.tabs.onRemoved.removeListener(handleRemoved);
    };
  }, []);
  
  return tabs;
}
```

## ğŸ¨ Tailwind CSS å¸¸ç”¨ç±»

### å¸ƒå±€
```css
/* Flexbox */
.flex .items-center .justify-between
.flex-col .flex-row .flex-wrap

/* Grid */
.grid .grid-cols-2 .grid-cols-3 .gap-4

/* é—´è· */
.p-4 .px-6 .py-2 .m-4 .mx-auto .space-y-2

/* å°ºå¯¸ */
.w-full .h-screen .max-w-md .min-h-0
```

### æ ·å¼
```css
/* é¢œè‰² */
.bg-blue-500 .text-white .border-gray-300

/* å­—ä½“ */
.text-lg .font-bold .leading-relaxed

/* åœ†è§’å’Œé˜´å½± */
.rounded-lg .shadow-md .shadow-lg

/* çŠ¶æ€ */
.hover:bg-blue-600 .focus:ring-2 .disabled:opacity-50
```

## ğŸ“± å¸¸ç”¨ç»„ä»¶æ¨¡å¼

### æŒ‰é’®ç»„ä»¶
```typescript
interface ButtonProps {
  variant?: 'primary' | 'secondary';
  size?: 'sm' | 'md' | 'lg';
  children: React.ReactNode;
  onClick?: () => void;
}

const Button: React.FC<ButtonProps> = ({ 
  variant = 'primary', 
  size = 'md', 
  children, 
  onClick 
}) => {
  const baseClasses = 'inline-flex items-center justify-center font-medium rounded-md transition-colors';
  const variantClasses = {
    primary: 'bg-blue-600 text-white hover:bg-blue-700',
    secondary: 'bg-gray-200 text-gray-900 hover:bg-gray-300'
  };
  const sizeClasses = {
    sm: 'px-3 py-1.5 text-sm',
    md: 'px-4 py-2 text-sm',
    lg: 'px-6 py-3 text-base'
  };
  
  return (
    <button 
      className={`${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]}`}
      onClick={onClick}
    >
      {children}
    </button>
  );
};
```

### è¾“å…¥æ¡†ç»„ä»¶
```typescript
interface InputProps {
  label?: string;
  placeholder?: string;
  value: string;
  onChange: (value: string) => void;
}

const Input: React.FC<InputProps> = ({ label, placeholder, value, onChange }) => {
  return (
    <div>
      {label && (
        <label className="block text-sm font-medium text-gray-700 mb-1">
          {label}
        </label>
      )}
      <input
        type="text"
        placeholder={placeholder}
        value={value}
        onChange={(e) => onChange(e.target.value)}
        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
      />
    </div>
  );
};
```

## ğŸ” è°ƒè¯•æŠ€å·§

### Background Script è°ƒè¯•
```typescript
// åœ¨ background script ä¸­
console.log('Debug info:', data);

// æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯
// 1. æ‰“å¼€ chrome://extensions/
// 2. æ‰¾åˆ°ä½ çš„æ‰©å±•
// 3. ç‚¹å‡» "æ£€æŸ¥è§†å›¾: èƒŒæ™¯é¡µ"
```

### Content Script è°ƒè¯•
```typescript
// åœ¨ content script ä¸­
console.log('Content script debug:', data);

// æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯
// 1. æ‰“å¼€ç›®æ ‡ç½‘é¡µ
// 2. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
// 3. åœ¨ Console ä¸­æŸ¥çœ‹è¾“å‡º
```

### Popup è°ƒè¯•
```typescript
// åœ¨ popup ç»„ä»¶ä¸­
console.log('Popup debug:', data);

// æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯
// 1. å³é”®ç‚¹å‡»æ‰©å±•å›¾æ ‡
// 2. é€‰æ‹© "æ£€æŸ¥"
// 3. åœ¨å¼¹å‡ºçš„å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹
```

## ğŸ“¦ æ‰“åŒ…å‘å¸ƒ

### ç”Ÿäº§æ„å»º
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# åˆ›å»º ZIP åŒ…
npm run zip

# æ„å»ºè¾“å‡ºç›®å½•
.output/chrome-mv3/
â”œâ”€â”€ manifest.json
â”œâ”€â”€ popup.html
â”œâ”€â”€ options.html
â”œâ”€â”€ background.js
â”œâ”€â”€ content-scripts/
â””â”€â”€ assets/
```

### Chrome Web Store å‘å¸ƒ
1. è®¿é—® [Chrome å¼€å‘è€…æ§åˆ¶å°](https://chrome.google.com/webstore/devconsole/)
2. åˆ›å»ºæ–°çš„æ‰©å±•é¡¹ç›®
3. ä¸Šä¼  ZIP åŒ…
4. å¡«å†™æ‰©å±•ä¿¡æ¯
5. æäº¤å®¡æ ¸

## ğŸ› å¸¸è§é—®é¢˜

### æƒé™é”™è¯¯
```typescript
// é”™è¯¯ï¼šUnchecked runtime.lastError
// è§£å†³ï¼šæ£€æŸ¥æƒé™é…ç½®
{
  "permissions": ["activeTab", "storage", "tabs"]
}
```

### çƒ­é‡è½½ä¸å·¥ä½œ
```bash
# é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev

# æˆ–è€…é‡æ–°åŠ è½½æ‰©å±•
# åœ¨ chrome://extensions/ ä¸­ç‚¹å‡»åˆ·æ–°å›¾æ ‡
```

### TypeScript ç±»å‹é”™è¯¯
```typescript
// å®‰è£… Chrome ç±»å‹å®šä¹‰
npm install -D @types/chrome

// åœ¨ tsconfig.json ä¸­æ·»åŠ 
{
  "types": ["chrome"]
}
```

### CSS æ ·å¼ä¸ç”Ÿæ•ˆ
```typescript
// æ£€æŸ¥ Content Security Policy
// åœ¨ manifest ä¸­ç¡®ä¿ CSS æ–‡ä»¶è¢«æ­£ç¡®å¼•ç”¨
// é¿å…ä½¿ç”¨å†…è”æ ·å¼
```

## ğŸ“š å‚è€ƒèµ„æº

- [WXT å®˜æ–¹æ–‡æ¡£](https://wxt.dev/)
- [Chrome æ‰©å±•å¼€å‘æ–‡æ¡£](https://developer.chrome.com/docs/extensions/)
- [React å®˜æ–¹æ–‡æ¡£](https://react.dev/)
- [Tailwind CSS æ–‡æ¡£](https://tailwindcss.com/)
- [TypeScript æ–‡æ¡£](https://www.typescriptlang.org/)

---

è¿™ä¸ªå¿«é€Ÿå‚è€ƒæ¶µç›–äº† WXT æ‰©å±•å¼€å‘çš„æ ¸å¿ƒå†…å®¹ï¼Œå»ºè®®æ”¶è—å¤‡ç”¨ï¼ğŸš€
